<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>민감사건 체크리스트 완전판</title>
  
  <style>
   html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    min-height: 100vh;
    font-family: "Apple SD Gothic Neo", "Malgun Gothic", sans-serif;
    background: #f5f7fa;
    color: #222;
  }

    
  .section { margin-bottom: 2rem; background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    
  button { display: block; margin: 0.5rem 0; padding: 0.5rem 1rem; cursor: pointer; }
    
  .sub-content { margin-left: 1rem; margin-top: 0.5rem; background: #eef; padding: 0.5rem; border-radius: 4px; }

   #feedback-btn {
     margin: 0.3rem auto;    /* 이 버튼만 중앙 */
    }



 /* 로고 화면 스타일 */
  #logo-screen {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    background: #000;
  }

  #logo-screen img {
    max-width: 90%;
    max-height: 90%;
    cursor: pointer;
    transition: transform 2s ease, opacity 2s ease;
  }

  /* 로고 사라질 때 애니메이션 */
  .logo-zoom-out {
    transform: scale(1.5); /* 확대 */
    opacity: 0;             /* 사라짐 */
  }

  /* 매뉴얼 화면 숨김 + 초기 상태는 축소 */
 #manual-screen {
  /* display:none 제거 */
  padding: 1rem;
  transform: scale(0.8);
  opacity: 0;
  transition: transform 1s ease, opacity 1s ease;
  pointer-events: none; /* 숨겨져 있을 때 클릭 막기 */
}

#manual-screen.show {
  transform: scale(1);
  opacity: 1;
  pointer-events: auto;
}














    
  ul, li {
    list-style-type: none !important;
    margin: 0;
    padding: 0;
  }

  li::before {
    content: none !important;
  }

  li::marker {
    content: none !important;
  }

  .highlight { color: blue; font-weight: bold; }

  /* --- 모달(문서 미리보기 / 다운로드) 스타일 --- */
  .doc-modal {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1200;
    background: rgba(0,0,0,0.45);
  }
  .doc-modal.open { display: flex; }
  .doc-modal .box {
    width: 90%;
    max-width: 980px;
    height: 85%;
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }
  .doc-modal .header {
    padding: 0.6rem 1rem;
    border-bottom: 1px solid #eee;
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:8px;
  }
  .doc-modal .header .title { font-weight:600; }
  .doc-modal .header .actions { display:flex; gap:8px; align-items:center; }
  .doc-modal .content {
    flex:1;
    background:#fafafa;
    display:flex;
    align-items:center;
    justify-content:center;
    overflow:auto;
    padding:8px;
  }
  .doc-modal iframe, .doc-modal embed {
    width:100%;
    height:100%;
    border:0;
  }
  .doc-modal .notice {
    padding: 1rem;
    text-align: center;
    color: #333;
  }
  .link-button {
    border: 1px solid #ccc;
    background: #f6f6f6;
    padding: 0.4rem 0.7rem;
    border-radius: 6px;
    cursor:pointer;
    text-decoration: none;
    color: #111;
  }
  .hidden { display:none; }
  </style>
</head>
  
<body>


<!-- 로고 화면 -->
<div id="logo-screen">
  <img src="logo.png" alt="수배자 매뉴얼 로고" id="logo-img">
</div>

<div id="manual-screen">




  
<h1 style="text-align:center; margin-top:0; padding:1rem 0; font-size:1.8rem;">
    민감사건 체크리스트
</h1>
  
<div class="section">
  <h2>1. 사건 선택</h2>
  <label><input type="radio" name="사건" value="아동학대"> 아동학대</label>
  <label><input type="radio" name="사건" value="가정폭력"> 가정폭력</label>
  <label><input type="radio" name="사건" value="스토킹"> 스토킹</label>
  <label><input type="radio" name="사건" value="교제폭력"> 교제폭력</label>
</div>

<div class="section hidden" id="세부항목섹션">
  <h2>2. 절차 세부 항목</h2>
  <div id="세부항목버튼영역"></div>
</div>

<div class="section" id="필수서류섹션">
  <h2>3. 사건 접수 시 필수 서류</h2>
  <div id="필수서류버튼영역">
    <button data-항목="필수서류">필수서류</button>
    <button data-항목="유의사항">유의사항</button>
  </div>
</div>

<!-- 문서 미리보기 / 다운로드 모달 -->
<div id="docModal" class="doc-modal" role="dialog" aria-hidden="true">
  <div class="box" role="document">
    <div class="header">
      <div class="title" id="docTitle">문서</div>
      <div class="actions">
        <a id="docDownload" class="link-button" href="#" download>다운로드</a>
        <button id="docClose" class="link-button">닫기</button>
      </div>
    </div>
    <div class="content" id="docContent">
      <!-- PDF iframe/embed 또는 안내문이 여기에 들어감 -->
      <div class="notice" id="docNotice">문서를 불러오는 중입니다...</div>
    </div>
  </div>
</div>

<script>
function 색상변환(text) {
  return text
    .replace(/\|\|\|(.+?)\|\|\|/g, '<span style="color: green; font-weight: bold;">$1</span>')
    .replace(/\|\|(.+?)\|\|/g, '<span style="color: blue; font-weight: bold;">$1</span>')
    .replace(/\|(.+?)\|/g, '<span style="color: red; font-weight: bold;">$1</span>');
}

/* --- 기존 데이터(원본 그대로 유지) --- */
const 세부내용Depth = {
  "아동학대": {
    "현장출동": [
      { text: "□ 분리 및 조사", depth: 0 },
      { text: "□ |유의 사항|", depth: 0 },
      { text: "→ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>|18세 미만| '||아동||' 여부(|||고3 학생 일부 해당 안됨|||)</span>", depth: 1 },
      { text: "→'아동학대'란 ||보호자|| |||및||| ||성인||에 의한 학대", depth: 1 },
      { text: "□ ||아동학대 현장조사 체크리스트 작성||", depth: 0 }
    ],
    "응급조치(||경찰|| or ||전담공무원||)": [
      { text: "□ 보호자에 의한 아동학대 여부 검토", depth: 0 },
      { text: "➢ |보호자 아닌 ||기타 성인||에 의한 학대인 경우|", depth: 0.5 },
      { text: "→ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>||응급조치 및 긴급임시조치|| 등 |해당사항 없음|</span>", depth: 1 },
      { text: "□ 응급조치란", depth: 0 },
      { text: "➢ 아동학대범죄 현장을 발견한 경우", depth: 0.5 },
      { text: "➢ 다른 장소에서 학대피해가 확인되는 경우", depth: 0.5 },
      { text: "➢ 재학대의 위험이 급박ㆍ현저한 경우", depth: 0.5 },
      { text: "→ 1호: 아동학대범죄 행위의 ||제지||", depth: 1 },
      { text: "→ 2호: <span style='letter-spacing:-1px; word-spacing:-1.2px;'>아동학대행위자를 피해아동으로부터 ||격리||</span>", depth: 1 },
      { text: "→ 3호: ||보호시설로 인도||", depth: 1 },
      { text: "→ 4호: ||의료기관으로 인도||", depth: 1 },
      { text: "→ 5호: 피해아동등을 ||연고자 등에게 인도||", depth: 1 },
      { text: "□ 응급조치결과 보고서 작성", depth: 0 },
      { text: "□ |사후신청| ||의무|| |있음|(여청수사)", depth: 0 },
      { text: "➢ ||응급조치(2~5호)||시 |지체|없이", depth: 0.5 },
      { text: "→ 검사에게 ||임시조치의 청구를 신청|| ", depth: 1 },
    ],
     "긴급임시조치(||경찰||)": [
      { text: "□ |경찰직권| or |피해아동 등의 신청|에 따라", depth: 0 },
      { text: "➢ 응급조치에도 불구", depth: 0.5 },
      { text: "➢ ||아동학대범죄 재발 우려||가 있고", depth: 0.5 },
      { text: "➢ ||긴급||을 요할때", depth: 0.5 },
      { text: "→ 1호: ||주거로부터 퇴거 등 격리||", depth: 1 },
      { text: "→ 2호: ||접근 금지||", depth: 1 },
      { text: "→ 3호: ||전기통신을 이용한 접근 금지||", depth: 1 },
      { text: "□ ||긴급임시조치결정서 작성||(|사법경찰관|)", depth: 0 },
      { text: "→ ||긴급임시조치통보서 작성||(|사법경찰관|)", depth: 1 },
      { text: "- 긴급임시조치 고지 항목 가해자 서명", depth: 1.5 },
      { text: "※|||긴급임시조치결정서 작성|||하면 오른쪽 |||관련서식|||에 ||긴급임시조치통보서|| |||활성화됨|||", depth: 2 },
      { text: "※|||시ㆍ도지사 또는 시장ㆍ군수ㆍ구청장에게||| |지체 없이| 긴급임시조치 사실 |||통지|||(여성수사)", depth: 2 }, 
      { text: "□ 긴급임시조치 |위반시|", depth: 0 },
      { text: "→ 1000만원 이하 ||과태료||", depth: 1 },
      { text: "→ |||긴급임시조치위반자 통보서||| 발송", depth: 1 },
      { text: "- 지구대 ▸ 경찰서 여성보호계(오프라인)", depth: 1.5 },
      { text: "- 경찰서 여성보호계 ▸ 남부법원에 통보", depth: 1.5 },
      { text: "□ |사후신청| ||의무|| |있음|(여청수사→검사)", depth: 0 },
      { text: "➢ ||긴급임시조치를 한 경우||", depth: 0.5 },
      { text: "→ |지체|없이 ||임시조치의 청구를 신청", depth: 1 },
      { text: "□ 긴급임시조치 취소(여청수사)", depth: 0 },
      { text: "➢ ||검사가 임시조치를 청구하지 아니||하거나", depth: 0.5 },
      { text: "➢ ||법원이 임지조치의 결정을 하지 아니한때|| ", depth: 0.5 },
      { text: "→ |즉시| 긴급임시조치를 |취소|", depth: 1 },
    ],
     "임시조치 |신청|(||경찰 → 검사||)": [
      { text: "→ 응급조치 제2호~제4호 실시한 경우", depth: 0 },
      { text: "→ 긴급임시조치 실시 한 경우", depth: 0 },
    ],
     "임시조치 |청구|(||검사 → 법원||)": [
      { text: "→ 재발될 우려가 있다고 인정하는 경우", depth: 0 },
      { text: "→ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>|직권| 또는 |사법경찰관의 신청|에 따라</span>", depth: 0 },
    ],
    "임시조치 결정(||법원||)": [
      { text: "□ 판사 결정으로", depth: 0 },
      { text: "→ 1호: 퇴거 등 격리", depth: 1 },
      { text: "→ 2호: 접근 금지", depth: 1 },
      { text: "→ 3호: 통신 금지", depth: 1 },
      { text: "→ 4호: <span style='letter-spacing:-1px; word-spacing:-1.2px;'>친권 또는 후견인 권한 행사의 제한 또는 정지</span>", depth: 1 },
      { text: "→ 5호: <span style='letter-spacing:-1px; word-spacing:-1.2px;'>아동보호전문기관 등에의 상담 및 교육 위탁</span>", depth: 1 },
      { text: "→ 6호: <span style='letter-spacing:-1px; word-spacing:-1.2px;'>의료기관이나 등 요양시설에의 위탁</span>", depth: 1 },
      { text: "→ 7호: 유치장 또는 구치소에의 유치", depth: 1 },
      { text: "□ 임시조치 |위반시|", depth: 0 },
      { text: "→ 2년 ↓ ||징역|| 또는 2천만원 ↓ ||벌금||", depth: 1 },  
    ],
    "필수서류": [
      { text: "▸||아동학대 현장조사 체크리스트||", depth: 0 },
      { text: "▸||응급조치 보고서||", depth: 0 },
      { text: "▸||긴급임시조치결정서||", depth: 0 },
      { text: "▸||긴급임시조치통보서||", depth: 0 },
      { text: "▸||체포서|| or ||임의동행보고서|| or ||발생보고서||", depth: 0 }
    ],
    "유의사항": [
      { text: "?", depth: 0 },
      { text: "?", depth: 1 },
      { text: "?", depth: 1 }
    ]
  },

  "가정폭력": {
    "현장출동": [
      { text: "□ 가해자와 피해자 분리", depth: 0 },
      { text: "□ 진술 및 증거 확보", depth: 0 },
      { text: "□ <a href='https://www.law.go.kr/법령/가정폭력범죄의처벌등에관한특례법/제2조'>가족 구성원 여부 확인</a>", depth: 0 },
      { text: "→ 배우자(사실혼 포함) 등", depth: 1 },
      { text: "→ 자기 또는 배우자와 직계존비속 등", depth: 1 },
      { text: "→ 계부모 등", depth: 1 },
      { text: "→ |동거|하는 ||친족||", depth: 1 },
      { text: "□ 통합판단조사표 작성", depth: 0 },
      { text: "□ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>가정폭력 피해자 권리 및 지원 안내서(<span style='font-size:0.8em;'>피해자 배부</span>)</span>", depth: 0 },
      { text: "→ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>개인정보 수집 이용 및 제3자 제공동의서(<span style='font-size:0.8em;'>여청 인계</span>)</span>", depth: 1 },
      { text: "□ 사실혼 판단 체크리스트(서면)", depth: 0 },
      { text: "→ 법률혼 관계 아닌 경우", depth: 1 },
    ],
    "응급조치(||경찰||)": [
      { text: "□ 현장에서 즉시 응급조치", depth: 0 },
      { text: "→ 1호: 폭력행위의 ||제지|| 및 가ㆍ피해자의 ||분리||", depth: 1 },
      { text: "→ 1의2호: ||체포 등 범죄수사||", depth: 1 },
      { text: "→ 2호: ||상담소 또는 보호시설로 인도||", depth: 1 },
      { text: "(|피해자가 동의한 경우|)", depth: 2.5 },
      { text: "→ 3호: ||의료기관으로 인도||", depth: 1 },
      { text: "→ 4호: 재발 시 ||임시조치 신청 가능 통보||", depth: 1 },
      { text: "→ 5호: <span style='letter-spacing:-1px; word-spacing:-1.2px;'>||피해자보호명령  등  청구 가능  고지||</span>", depth: 1 },
      { text: "□ ||응급조치 보고서 작성||", depth: 0 },
      { text: "□ |사후신청| ||의무|| |없음|", depth: 0 },
    ],
    "긴급임시조치(||경찰||)": [
      { text: "□ |경찰 직권| 또는 |피해자 등 신청|에 따라", depth: 0 },
      { text: "➢ ||응급조치에도 불구||", depth: 0.5 },
      { text: "➢ 가정폭력범죄가 ||재발될 우려||가 있고", depth: 0.5 },
      { text: "➢ ||긴급||을 요할때", depth: 0.5 },  
      { text: "→ 1호: 주거 등 으로부터의 ||퇴거 등 격리||", depth: 1 },
      { text: "→ 2호: ||접근 금지||", depth: 1 },
      { text: "→ 3호: ||전기통신을 이용한 접근 금지||", depth: 1 },
      { text: "□ ||긴급임시조치결정서 작성||(|사법경찰관|)", depth: 0 },
      { text: "→ 긴급임시조치 ||통보서||", depth: 1 },
      { text: "- |||가해자 에게 교부|||", depth: 1.5 },
      { text: "→ 긴급임시조치 ||확인서||", depth: 1 },
      { text: "- 가해자 확인 서명", depth: 1.5 },
      { text: "※ 확인서 날인거부시 수사보고 첨부", depth: 1.5 },
      { text: "□ 긴급임시조치 |위반시|", depth: 0 },
      { text: "→ 300만원 이하 ||과태료||", depth: 1 },
      { text: "→ |||긴급임시조치위반자 통보서||| 발송", depth: 1 },
      { text: "- 지구대 ▸  경찰서 ||여성보호계||(오프라인)", depth: 1.5 },
      { text: "- 경찰서 여성보호계 ▸ 남부법원에 통보", depth: 1.5 },
      { text: "□ |사후신청| ||의무|| |있음|(여청수사 → 검사)", depth: 0 },
      { text: "➢ ||긴급임시조치를 한 경우||", depth: 0.5 },
      { text: "→ |지체| 없이 임시조치를 신청", depth: 1 },
      { text: "□ 긴급임시조치 취소(여청수사)", depth: 0 },
      { text: "➢ ||검사가 임시조치를 청구하지 아니한 경우||", depth: 0.5 },
      { text: "➢ ||법원이 임지조치의 결정을 하지 아니한 경우||", depth: 0.5 },
      { text: "→ |즉시| 긴급임시조치를 |취소|", depth: 1 },
    ],
    "임시조치 신청(||경찰 → 검사||)": [
      { text: "➢ 사법경찰관이 긴급임시조치를 한 경우", depth: 0 },
      { text: "→ |지체| 없이 임시조치를 신청", depth: 0.5 },
    ],
     "임시조치 청구(||검사||)": [
      { text: "▸법원에 임시조치 청구", depth: 0 },
    ],    

    "임시조치 결정(||법원||)": [
      { text: "□ 결정 내용", depth: 0 },
      { text: "→ 1호: ||퇴거 등 격리||", depth: 1 },
      { text: "→ 2호: ||접근 금지||", depth: 1 },
      { text: "→ 3호: ||전기통신을 이용한 접근 금지||", depth: 1 },
      { text: "→ 4호: ||의료기관이나 그 밖의 요양소에의 위탁||", depth: 1 },
      { text: "→ 5호: ||유치장 또는 구치소 유치||(1~3호 위반시)", depth: 1 },
      { text: "→ 6호: 상담소등에 ||상담위탁||", depth: 1 },
      { text: "□ 위반시", depth: 0 },
      { text: "→ 1년 ↓ ||징역|| 또는 1천만원 ↓ ||벌금||", depth: 1 },
    ],

    "필수서류": [
      { text: "→ ||통합판단조사표||", depth: 0 },
      { text: "→ ||가정폭력 피해자 권리 및 지원 안내서||(상담 지원기관 연계를 위한 ||개인정보 수집 이용 및 제3자 제공동의서||)", depth: 0 },
      { text: "→ ||응급조치 보고서||", depth: 0 },
      { text: "→ ||긴급임시조치 결정서||", depth: 0 },
      { text: "→ ||긴급임시조치 통보서||(|||가해자 서명|||)", depth: 0 },
      { text: "→ ||긴급임시조치 확인서||(|||가해자 교부|||)", depth: 0 },
      { text: "→ ||체포서|| or ||동행보고서|| or ||발생보고서||", depth: 0 },
    ],
    "유의사항": [
      { text: "?", depth: 0 },
      { text: "?", depth: 1 },
      { text: "?", depth: 1 }
    ]
  },

  "스토킹": {
    "현장출동": [
      { text: "□ 제지, 경고 및 분리", depth: 0 },
      { text: "□ ||스토킹 행위||란", depth: 0 },
      { text: "➢ 상대방의 |의사|(|||x명시적 의사x|||)에 반하여", depth: 0.5 },
      { text: "➢ ||정당한 이유 없이||", depth: 0.5 },
      { text: "➢ ||불안감|| 또는 ||공포심||을 일으키는 행위", depth: 0.5 },
      { text: "→ ||접근|| or ||따라다님|| or ||진로를 막음||", depth: 1 },
      { text: "→ ||기다림|| or ||지켜봄||", depth: 1 },
      { text: "→ |||정보통신망을 이용||| ||물건등||을 ||도달|| or |나타나게 함|", depth: 1 },
      { text: "※ 나타나게 하는 행위: 부재중 전화", depth: 1.5 },
      { text: "→ ||직접|| 또는 ||제3자||를 통하여 ||물건등||을 ||도달||하게 하거나 ||주거등 또는 그 부근||에 ||물건등을 둠||", depth: 1 },
      { text: "※ 물건등 에는 제한 없음(층간소음)", depth: 1.5 },
      { text: "→ 상대방 정보를 ||정보통신망을 이용||, |제3자| ||제공, 배포, 게시||", depth: 1 },
      { text: "※ 상대방등의 정보: 개인정보, 위치정보, 정보주체를 식별할 수 있을 정도의 가공한 정보", depth: 1.5 },
      { text: "→ ||정보통신망을 이용|| 자신이 ||상대방등인 것처럼 가장||", depth: 1 },
      { text: "□ |반의사불벌죄 아님|", depth: 0 },
      { text: "□ 증거 확보", depth: 0 },
      { text: "□ '통합판단조사표 작성'", depth: 0 },
      { text: "□ 스토킹 데이트폭력 피해자 권리지원 안내서", depth: 0 },
      { text: "→ 피해자에게 교부", depth: 1 },
    ],
     "응급조치(||경찰||)": [
      { text: "□ 진행 중인 스토킹행위에 대하여", depth: 0 },
      { text: "→ 1호: 제지, 중단 통보 및 |서면경고|(경고장)", depth: 0.5},
      { text: "→ 2호: 분리 및 범죄수사", depth: 0.5 },
      { text: "→ 3호: <span style='letter-spacing:-1px; word-spacing:-1px;'>긴급응급조치 및 잠정조치 요청 절차 안내</span>", depth: 0.5 },
      { text: "→ 4호: 상담소 또는 보호시설로의 피해자 인도", depth: 0.5 },
      { text: "(|피해자등이 동의한 경우|)", depth: 2.5 },
      { text: "□ ||응급조치 보고서 작성||", depth: 0 },
      { text: "□ |사후신청| ||의무|| |없음|", depth: 0 }, 
    ],
    "긴급응급조치(||경찰||)": [
      { text: "□ 경찰 직권 또는 피해자 등의 신청에 의하여 ", depth: 0 },
      { text: "➢ 스토킹 행위의 지속 및 반복 우려", depth: 0.5 },
      { text: "➢ 예방을 위하여 긴급을 요하는 경우", depth: 0.5 },
      { text: "→ 1호: 접근 금지", depth: 1 },
      { text: "→ 2호: 전기통신을 이용한 접근 금지", depth: 1 },
      { text: "□ ||긴급응급조치결정서 작성||(|사법경찰관|)", depth: 0 },
      { text: "→ ||긴급응급조치 고지서||", depth: 1 },
      { text: "- 가해자에게 배부", depth: 1.5 },
      { text: "※긴급응급조치의 내용 및 불복 방법 등 고지(고지서 및 확인서 문구에 포함됨)", depth: 1.5 },
      { text: "※고지서를 직접 교부하지 못한 경우 휴대폰 메세지, 등기 등을 이용하고 수사기록 유지", depth: 1.5 },
      { text: "→ ||확인서||", depth: 1 },
      { text: "- 날인거부시 수사보고", depth: 1.5 },
      { text: "→ ||긴급응급조치 통지||", depth: 1 }, 
      { text: "- 피해자에게 통지", depth: 1.5 },
      { text: "- 가해자의 개인정보 비식별처리|)", depth: 1.5 }, 
      { text: "→ ||피해자권리고지 안내서 배부||", depth: 1 },
      { text: "□ 긴급응급조치 |위반시|", depth: 0 },
      { text: "→ 1년 ↓ ||징역|| 또는 1천만원 ↓ ||벌금||", depth: 1 },
      { text: "□ 사후승인 신청 의무 있음(||여청수사→검사||)", depth: 0 },
      { text: "➢ ||긴급응급조치를 하였을 때||", depth: 0.5},
      { text: "→ |지체 없이| 긴급응급조치를 |신청|해야 함", depth: 1 },
      { text: "※ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>실무상 잠정조치 신청과 함께 실시함</span>", depth: 1.5 },
      { text: "□ 긴급응급조치 취소(여청수사)", depth: 0 },
      { text: "➢ <span style='letter-spacing:-1px; word-spacing:-1.2px;'>검사의 긴급응급조치  ||사후승인  미청구|| 시</span>", depth: 0.5 },
      { text: "➢ 판사가 ||사후승인을 하지 아니한때||", depth: 0.5 },
      { text: "→ |즉시| 긴급응조치를 |취소|해야 함", depth: 1 },
    ],
     
     "잠정조치 청구(||검사→법원||)": [
      { text: "→ 피해자 요청", depth: 0 },
      { text: "→ 사법경찰관의 신청 및 검사 직권", depth: 0 },
    ],
     "잠정조치 결정(||법원||)": [
      { text: "□ 법원의 결정으로", depth: 0 },
      { text: "→ 1호: ||스토킹범죄 중단에 관한 서면 경고||", depth: 1 },
      { text: "→ 2호: ||접근 금지||", depth: 1 },
      { text: "→ 3호: ||전기통신을 이용한 접근 금지||", depth: 1 },
      { text: "→ 3의 2호: ||전자장치의 부착||", depth: 1 },
      { text: "→ 4호: ||유치장 또는 구치소에의 유치||", depth: 1 },

      { text: "□ 잠정조치 |위반시|", depth: 0 },
      { text: "→ 3년 ↓ 징역 또는 3천만원 ↓ 벌금", depth: 1 },
      { text: "(전자장치 효용을 해한 사람)", depth: 1.5 },
      { text: "→ 2년 ↓ 징역 또는 2천만원 ↓ 벌금", depth: 1 },
      { text: "(접근금지 및 전기통신을 이용한 접근금지 위반)", depth: 1.5 },
    ],


    "필수서류": [
      { text: "▸||통합판단조사표||", depth: 1 },
      { text: "▸||스토킹 데이트폭력 피해자 권리지원 안내서||", depth: 1 },
      { text: "▸||경고장||", depth: 1 },
      { text: "▸||응급조치 보고서||", depth: 1 },
      { text: "▸||긴급응급조치결정서||", depth: 1 },
      { text: "▸||긴급응급조치 고지서<span style='font-size:0.75em;'>(|||대상자 교부|||)</span>|| 및 ||확인서||", depth: 1 },
      { text: "▸||긴급응급조치 통지서||<span style='font-size:0.75em;'>(|||피해자 교부|||)</span>", depth: 1 },
      { text: "▸||체포서|| or ||임동보고서|| or ||발생보고서||", depth: 1 }
    ],
    "유의사항": [
      { text: "□ |수사를 담당하거나 관여한 경찰관|이 ||피해자를 특정하여 파악할 수 있는 정보와 사생활 누설||한 경우", depth: 0 },
      { text: "▸3년 ↓ |징역| 또는 3천만원 ↓ |벌금|", depth: 1 },
    ]
  },

  "교제폭력": {
    "현장출동": [
      { text: "□ 가해자 경고 및 분리", depth: 0 },
      { text: "□ 사실혼 판단 체크리스트 작성", depth: 0 },
      { text: "□ ||경고장|| 및 ||피해자권리고지안내서|| 배부", depth: 0 }
    ],
    "필수서류": [
      { text: "▸||사실혼 판단 체크리스트||", depth: 0 },
      { text: "▸||경고장||", depth: 0 },
      { text: "▸||피해자권리고지안내서||", depth: 0 },
      { text: "▸||체포서|| or ||임동보고서|| or ||발생보고서||", depth: 0 }

    ],
    "유의사항": [
      { text: "?", depth: 0 },
      { text: "?", depth: 1 },
      { text: "?", depth: 1 }
    ]
  }
};

/* --- 문서 매핑 로직 ---
   1) 같은 폴더에 documents.json 있으면 사용(권장)
      형식 예:
      {
        "사실혼_판단_체크리스트": "facts_unmarried_checklist.pdf",
        "통합판단조사표": "integration_form.pdf",
        ...
      }
   2) documents.json 없으면 기본 후보 파일명 목록을 자동 시도
*/
let DOC_MAP = {}; // key -> relative file path
const DEFAULT_CANDIDATES = {
  "사실혼_판단_체크리스트": [
    "사실혼판단체크리스트.pdf",
    "사실혼판단체크리스트.hwp",
    "사실혼_판단_체크리스트.docx",
    "fact_marriage_checklist.pdf",
    "fact_marriage_checklist.hwp"
  ],
  "경고장": [
    "경고장.pdf",
    "경고장.hwp",
  ],
   "가정폭력 피해자 권리 및 지원 안내서": [
    "가정폭력 피해자 권리 및 지원 안내서.pdf",
    "가정폭력 피해자 권리 및 지원 안내서.hwp",
  ],
   "스토킹 데이트폭력 피해자 권리지원 안내서": [
    "스토킹 데이트폭력 피해자 권리지원 안내서.pdf",
    "스토킹 데이트폭력 피해자 권리지원 안내서.hwp",
  ],
  // 필요하면 다른 문서 키에 대한 후보를 여기 추가 가능
};

async function loadDocumentsJson() {
  try {
    const r = await fetch('./documents.json', {cache: "no-cache"});
    if (!r.ok) throw new Error('no documents.json');
    const j = await r.json();
    DOC_MAP = j;
    console.log('documents.json loaded', DOC_MAP);
  } catch (e) {
    // documents.json 없으면 빈 맵 유지(후보 탐색 사용)
    console.log('documents.json not found; will try default candidates');
  }
}

/* 파일 존재 확인(같은 origin) */
async function existsFile(path) {
  try {
    const res = await fetch(path, { method: 'GET', cache: "no-cache" });
    return res.ok;
  } catch (e) {
    return false;
  }
}

/* 주어진 문서 키에 대해 실제 사용 가능한 파일 경로를 반환 */
async function resolveDocumentPath(key) {
  // 1) documents.json에 명시적 경로가 있으면 우선 사용
  if (DOC_MAP && DOC_MAP[key]) {
    const p = DOC_MAP[key];
    if (await existsFile(p)) return p;
    // 문서맵에 있으나 파일이 없으면 계속해서 후보 탐색
  }

  // 2) 후보 목록 시도
  const candidates = DEFAULT_CANDIDATES[key] || [];
  for (const c of candidates) {
    if (await existsFile(c)) return c;
  }

  // 3) 못찾음
  return null;
}

/* --- 기존 UI 렌더링 코드(대체 없이 동일) --- */
function clearSubContents() {
  document.querySelectorAll('.sub-content').forEach(el => el.remove());
}

function createSubContentDepth(사건, 항목) {
  const 내용Div = document.createElement('div');
  내용Div.className = 'sub-content';
  const ul = document.createElement('ul');

  const 항목내용 = 세부내용Depth[사건]?.[항목] || [];
  항목내용.forEach(item => {
    const li = document.createElement('li');
    li.style.paddingLeft = `${item.depth * 20}px`; // depth에 따라 들여쓰기

    // 텍스트 변환
    const rawHtml = 색상변환(item.text);

    // Special: '사실혼 판단 체크리스트'가 포함된 항목이면 클릭 가능한 링크로 변환
    // (또는 '사실혼' 키워드 포함 시에도 동작)
    if (/사실혼\s*판단\s*체크리스트|사실혼|경고장|피해자권리고지안내서|가정폭력 피해자 권리 및 지원 안내서|스토킹 데이트폭력 피해자 권리지원 안내서|통합판단조사표/.test(item.text)) {
      const a = document.createElement('a');
      a.href = "javascript:void(0)";
      a.innerHTML = applyTextTransforms(item.text, item.depth);
      a.style.textDecoration = 'underline';
      a.style.cursor = 'pointer';

      a.addEventListener('click', async (e) => {
        let docKey = "";
        let title = "";

        if (/사실혼/.test(item.text)) {
          docKey = "사실혼_판단_체크리스트";
          title = "사실혼 판단 체크리스트";
        } else if (/경고장/.test(item.text)) {
          docKey = "경고장";
          title = "경고장";
        } else if (/피해자권리고지안내서/.test(item.text)) {
          docKey = "피해자권리고지안내서";
          title = "피해자 권리 고지 안내서";
        } else if (/통합판단조사표/.test(item.text)) {
          docKey = "통합판단조사표";
          title = "통합 판단 조사표";
        } else if (/가정폭력 피해자 권리 및 지원 안내서/.test(item.text)) {
          docKey = "가정폭력 피해자 권리 및 지원 안내서";
          title = "가정폭력 피해자 권리 및 지원 안내서";
        } else if (/스토킹 데이트폭력 피해자 권리지원 안내서/.test(item.text)) {
          docKey = "스토킹 데이트폭력 피해자 권리지원 안내서";
          title = "스토킹 데이트폭력 피해자 권리지원 안내서";
        }
        if (docKey) await openDocumentModal(docKey, title);
      });

      li.appendChild(a);
    } else {
      li.innerHTML = applyTextTransforms(item.text, item.depth);
    }

    ul.appendChild(li);
  });

  내용Div.appendChild(ul);
  return 내용Div;
}

/* --- 사건 선택 및 버튼 생성 (원본대로) --- */
let currentEvent = null;

document.querySelectorAll('input[name="사건"]').forEach(radio => {
  radio.addEventListener('change', () => {
    const 사건 = radio.value;
    currentEvent = 사건;
    const 세부버튼영역 = document.getElementById('세부항목버튼영역');
    세부버튼영역.innerHTML = '';
    const 항목들 = Object.keys(세부내용Depth[사건])
                     .filter(항목 => 항목 !== "필수서류" && 항목 !== "유의사항");
    항목들.forEach(항목 => {
      const btn = document.createElement('button');
      btn.innerHTML = 색상변환(항목);
      btn.addEventListener('click', () => {
        clearSubContents();
        const 내용 = createSubContentDepth(사건, 항목);
        btn.insertAdjacentElement('afterend', 내용);
      });
      세부버튼영역.appendChild(btn);
    });
    document.getElementById('세부항목섹션').classList.remove('hidden');
  });
});

document.querySelectorAll('#필수서류버튼영역 button').forEach(btn => {
  btn.addEventListener('click', () => {
    if (!currentEvent) { alert("먼저 사건을 선택해주세요."); return; }
    clearSubContents();
    const 내용 = createSubContentDepth(currentEvent, btn.dataset.항목); // btn의 data-항목 값으로 선택
    btn.insertAdjacentElement('afterend', 내용);
  });
});

/* --- 문서 모달 관련 함수 --- */
const modal = document.getElementById('docModal');
const docTitle = document.getElementById('docTitle');
const docContent = document.getElementById('docContent');
const docNotice = document.getElementById('docNotice');
const docDownload = document.getElementById('docDownload');
const docClose = document.getElementById('docClose');

docClose.addEventListener('click', closeDocumentModal);
modal.addEventListener('click', (e) => {
  if (e.target === modal) closeDocumentModal();
});

function openDocumentModal(docKey, friendlyName) {
  return (async () => {
    docTitle.textContent = friendlyName || docKey;
    docContent.innerHTML = '';
    docContent.appendChild(docNotice);
    docNotice.textContent = '문서를 찾는 중입니다...';
    docNotice.style.display = 'block';
    modal.classList.add('open');
    modal.setAttribute('aria-hidden', 'false');

    // Resolve document path (문서가 있으면 path 반환, 없으면 null)
    const path = await resolveDocumentPath(docKey);
    if (!path) {
      docNotice.textContent = '파일이 존재하지 않습니다. 해당 문서를 같은 폴더에 업로드하시거나 documents.json에 경로를 등록해 주세요.';
      docDownload.href = '#';
      docDownload.style.display = 'none';
      return;
    }

    // 파일이 존재하면 확장자별 처리 (pdf -> iframe/embed, hwp/docx -> 다운로드)
    const ext = path.split('.').pop().toLowerCase();
    docDownload.href = path;
    docDownload.style.display = 'inline-block';
    docDownload.setAttribute('download', '');

    if (ext === 'pdf') {
      // PDF 미리보기
      docContent.innerHTML = '';
      const embed = document.createElement('embed');
      embed.type = 'application/pdf';
      embed.src = path;
      embed.onload = () => { /* 로드됨 */ };
      docContent.appendChild(embed);
    } else if (ext === 'hwp' || ext === 'hwpx') {
      // 브라우저에서 미리보기 불가: 안내 + 다운로드
      docContent.innerHTML = '';
      const p = document.createElement('div');
      p.className = 'notice';
      p.innerHTML = '이 파일은 한글(HWP) 형식입니다. 브라우저에서 미리보기할 수 없습니다. 아래 "다운로드" 버튼을 눌러 파일을 열어주세요.';
      docContent.appendChild(p);
    } else {
      // 기타 문서 (docx 등) — 안내 및 다운로드
      docContent.innerHTML = '';
      const p = document.createElement('div');
      p.className = 'notice';
      p.innerHTML = '브라우저에서 미리보기가 지원되지 않는 파일 형식입니다. 아래 "다운로드" 버튼을 눌러 파일을 열어주세요.';
      docContent.appendChild(p);
    }
  })();
}

function 글자크기적용(text, depth) {
  if (depth === 0) {
    return `<span style="font-size:0.9em;">${text}</span>`;
  } else if (depth === 0.5) {
    return `<span style="font-size:0.85em;">${text}</span>`;  // ★ 추가됨
  } else if (depth === 1) {
    return `<span style="font-size:0.8em;">${text}</span>`;
  } else if (depth === 1.5) {
    return `<span style="font-size:0.75em;">${text}</span>`;
  } else if (depth === 2) {
    return `<span style="font-size:0.70em;">${text}</span>`;
  } else if (depth === 2.5) {
    return `<span style="font-size:0.65em;">${text}</span>`;
  }
  return text;
}

function applyTextTransforms(text, depth) {
  // 색상 → 폰트 크기 순서 적용
  return 글자크기적용(색상변환(text), depth);
}


function closeDocumentModal() {
  modal.classList.remove('open');
  modal.setAttribute('aria-hidden', 'true');
}

/* --- 초기화: documents.json 로드 시도 --- */
loadDocumentsJson();
</script>


<!-- 여기에 의견 남기기 버튼 삽입 -->
<div style="text-align: center;">
  <button 
    id="feedback-btn"
    style="padding:12px 20px; font-size:16px; background:#007bff; color:white; border:none; border-radius:6px; cursor:pointer;"
    onclick="window.open('https://tally.so/r/EkKL2A', '_blank');"
  >
    오류 & 추가 의견 남기기
  </button>
</div>

</div>


<script>
  const logoImg = document.getElementById('logo-img');
  const logoScreen = document.getElementById('logo-screen');
  const manualScreen = document.getElementById('manual-screen');

  logoImg.addEventListener('click', () => {
    logoImg.classList.add('logo-zoom-out');

    setTimeout(() => {
      logoScreen.style.display = 'none';
    
      // display는 항상 block, 클래스로 등장 효과 적용
      manualScreen.classList.add('show');
    }, 2000);
  });
</script>


  
</body>
</html>



















































